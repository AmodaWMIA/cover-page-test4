<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Cover Page Generator</title>
<style>
  html, body {height: 100%;margin: 0;font-family:'Times New Roman', Times, serif;background: #4fc3f7;text-transform: uppercase;}
  .app {max-width: 980px;margin: 8px auto;padding: 8px;}
  .page {width: 210mm;height: 297mm;background: white;box-sizing: border-box;margin: auto;position: relative;overflow-wrap: break-word;font-family: 'Times New Roman', Times, serif;}
  .page-inner {position: absolute;left: 25mm;top: 10mm;right: 10mm;bottom: 10mm;border: 1px solid #000;padding: 4mm;box-sizing: border-box;}
  .top-right, .bottom-right {position: absolute;left: 50%;text-align: left;white-space: pre-line;}
  .top-right {top: 5mm;font-size:25px;line-height: 1.3;}
  .bottom-right {bottom:5mm;font-size: 15px;line-height: 1.2;}
  .center-title {position:relative;left: 50%;transform: translate(-50%,-50%);top: calc(10mm + 90mm);font-size: 39px;text-align:center; line-height: 1.5;padding: 0 5mm;}
  .middle-left {position: absolute;left: 5mm;top: calc(10mm + 120mm);font-size: 15px;line-height: 1.2;white-space: pre-line;}
  .form {background: #fff;border-radius: 8px;padding: 12px;margin: 10px 0;box-shadow: 0 1px 4px rgba(0,0,0,0.08);}
  .form label {font-size: 14px;display:block;margin-top:8px;}
  .form input[type="text"], .form textarea, .form select, .form input[type="date"] {
    width:100%;padding:8px;box-sizing:border-box;font-family: 'Times New Roman', Times, serif;text-transform:uppercase;margin-top:6px;font-size:14px;
  }
  .btn{display:block;width:100%;padding:12px;margin-top:10px;background:#00e676;color:#222;border-radius:8px;font-size:16px;cursor: pointer;text-align: center;}
  .top-right td:last-child {
    text-align: left;padding-right: 2mm;
  }

</style>
</head>
<body>
<div class="app">
  <h2>Cover Page Generator</h2>
  <div class="page" id="pagePreview">
    <div class="page-inner" id="pageInner">
      <div class="top-right" id="topRightBlock"></div>
      <div class="center-title" id="centerTitle"></div>
      <div class="middle-left" id="middleLeftBlock"></div>
      <div class="bottom-right" id="bottomRightBlock"></div>
    </div>
  </div>
  <div class="form" id="form">
    <label>Experiment No</label><input id="expNo" type="text">
    <label>Subject name</label><textarea id="subject"></textarea>
    <label>Subject code</label><input id="subjectCode" type="text">
    <label>Experiment title (main center)</label><input id="expTitle" type="text">
    <label>Instructed by</label><input id="instructor" type="text">
    <label>Group</label><input id="group" type="text">
    <label>Group members (one per line)</label><textarea id="members"></textarea>
    <label>Name</label><textarea id="name"></textarea>
    <label>Reg No</label><input id="regNo" type="text">
    <label>Course</label>
    <select id="course">
      <option>HNDE EE</option><option>HNDE ME</option><option>HNDE BSE</option><option>HNDE CE</option>
    </select>
    <label>Date of Ins</label><input id="dateIns" type="date">
    <label>Date of Sub</label><input id="dateSub" type="date">
    <button class="btn" id="downloadPDF">Download PDF</button>
    <button class="btn" id="downloadDOCX">Download DOCX</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.0.0/docx.min.js"></script>

<script>
const el = id => document.getElementById(id);
function formatDateDDMMYYYY(iso){if(!iso)return'';const[y,m,d]=iso.split('-');return`${d}/${m}/${y}`;}
function updatePreview(){
  el('topRightBlock').innerHTML = `<table><tr><td>Experiment NO: ${el('expNo').value}</td></tr><tr><td>${el('subject').value}</td></tr><tr><td>${el('subjectCode').value}</td></tr></table>`;
  el('centerTitle').textContent = el('expTitle').value;
  const members = el('members').value.split(/\r?\n/).map(x=>x.trim()).filter(Boolean).map(m=>`<tr><td></td><td>${m}</td></tr>`).join('');
  el('middleLeftBlock').innerHTML = `<table><tr><td>INSTRUCTED BY</td><td>: ${el('instructor').value}</td></tr><tr><td>GROUP</td><td>: ${el('group').value}</td></tr><tr><td>GROUP MEMBERS</td><td>:</td></tr>${members}</table>`;
  el('bottomRightBlock').innerHTML = `<table><tr><td>NAME</td><td>: ${el('name').value}</td></tr><tr><td>REG NO</td><td>: ${el('regNo').value}</td></tr><tr><td>COURSE</td><td>: ${el('course').value}</td></tr><tr><td>DATE OF INS</td><td>: ${formatDateDDMMYYYY(el('dateIns').value)}</td></tr><tr><td>DATE OF SUB</td><td>: ${formatDateDDMMYYYY(el('dateSub').value)}</td></tr></table>`;
}
[...document.querySelectorAll('#form input, #form textarea, #form select')].forEach(inp=>inp.addEventListener('input',updatePreview));
updatePreview();
document.getElementById('downloadPDF').addEventListener('click',async()=>{
  updatePreview();
  const element=document.getElementById('pagePreview');
  const opt={margin:0,filename:'cover_page.pdf',image:{type:'jpeg',quality:1},html2canvas:{scale:2},jsPDF:{unit:'mm',format:'a4',orientation:'portrait'}};
  await html2pdf().set(opt).from(element).save();
});
document.getElementById('downloadDOCX').addEventListener('click',async()=>{
  const doc=new docx.Document({sections:[{children:[new docx.Paragraph({text:document.getElementById('pageInner').innerText,spacing:{after:200}})]}]});
  docx.Packer.toBlob(doc).then(blob=>{const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='cover_page.docx';a.click();});
});
</script>
</body>
</html>
